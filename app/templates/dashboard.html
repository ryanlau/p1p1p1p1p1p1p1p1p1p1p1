{% import 'macros.html' as macros %}
{% extends "layout.html" %}

{% block title %} dashboard {%endblock%}
{% block content %}


<div class="m-3 m-x-lg-5">
    <header class="mt-3 mx-2">
            <div class="d-flex align-items-center justify-content-between">
                <div class="text-start"> <h4 id="time"></h4></div>
                <!-- line below is not truly centered!! -->
                <div class="text-center flex-grow-1"><h2>good morning, {{username}}</h2></div>
                <div class="text-end "><h4> <a href="/logout" class="text-reset text-decoration-none">logout</a></h4></div>
            </div>

            <div class="row">
                <div class="col">
                    <p class="text-center">
                        "There is only one thing that makes a dream impossible to achieve: the fear of failure."
                    </p>
                </div>
            </div>
    </header>


    <div class="row">
        <div class="col-12 col-lg-4">
            {% call macros.card('news') %}
                poopity
            {% endcall %}
        </div>
        <div class="col-12 col-lg-4">
            {% call macros.card('weather') %}
                poopity
            {% endcall %}
            {% call macros.card('stocks') %}
                <div class="row py-2 gy-4">
                    {% for ticker, data in stock_data.items() %}
                        {{ macros.stock_card(ticker, data.name, data.price, data.change) }}
                    {% endfor %}
                </div>

                <button type="button" class="btn btn-secondary mt-2" data-bs-toggle="modal" data-bs-target="#add-stock">
                    add stock to watchlist
                </button>
            {% endcall %}
        </div>
        <div class="col-12 col-lg-4">
            {% call macros.card('todos') %}
                poopity
            {% endcall %}
        </div>
    </div>
</div>



<div class="modal fade" id="add-stock" tabindex="-1" aria-labelledby="add-stock-modal" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5">add stock to watchlist</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="add-stock-form" action="/api/stocks/add" method="POST">
            <label for="stock-ticker" class="form-label">ticker</label>
            <input name="ticker" type="text" id="stock-ticker" placeholder="AAPL" class="form-control">
            <div class="form-text mt-3">If ticker does not exist, nothing will be added to your watchlist.</div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">close</button>
        <button type="submit" form="add-stock-form" class="btn btn-primary">add stock</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="static/js/stocks.js"></script>
<script src="static/js/time.js"></script>
<script>
    createCharts({{stock_data|tojson}})
</script>


{% endblock %}
